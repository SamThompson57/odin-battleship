(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};function e(){if(!0===b.gameOver)return;const t=document.getElementById("announcer");!1===b.mainState&&(t.textContent=`Place your (${b.shipArr[b.playerA.playerBoard.totalShips]} square long) Ship`)}t.d({},{R:()=>b});const n="abcdefghij".split("");class o{constructor(t){this.location=t,this.contains=null,this.targetable=!0}}const r=(t,e)=>({board:function(){let r=[];for(let i=1;i<e+1;i++){let e=[];for(let r=0;r<t;r++){const t=new o(n[r]+i);e.push(t)}r.push(e)}return r}(),placeShip:function(t,e,o,r){console.log(e);const i=function(t){let e=[];const o=t.split(""),r=Number(o.slice(1).join("")),i=n.indexOf(o[0]);return e.push(r-1),e.push(i),e}(e);console.log(i);const l=i[0],a=i[1];let s=0,c=0;o>0?c=1:s=1;for(let e=0;e<t.length;e++){if(void 0===this.board[l+c*e]||void 0===this.board[l+c*e][a+s*e])return console.log("Illegal placement: Undefined Space"),!1;if(null!=this.board[l+c*e][a+s*e].contains)return console.log("Illegal placement: Space occupied"),!1}for(let e=0;e<t.length;e++)this.board[l+c*e][a+s*e].contains=t,"A"===r&&document.getElementById(`${n[a+s*e]}${l+c*e+1}${r}`).setAttribute("class","ship");return this.totalShips++,!0},receiveAttack:function(t,e,o){if(!0===b.gameOver)return!1;if(void 0===this.board[e-1]||void 0===this.board[e-1][t])return!1;if(!this.board[e-1][t].targetable)return!1;if(this.board[e-1][t].targetable=!1,this.attackedSpaces.push(this.board[e-1][t]),this.board[e-1][t].contains){this.board[e-1][t].contains.hit();const r=document.createElement("img");return document.getElementById(`${n[t]}${e}${o}`).appendChild(r),r.src="../img/hit.png",this.board[e-1][t].contains.isSunk()?(this.sunkShips++,this.noShipsLeft()?(b.gameOver=!0,document.getElementById("announcer").textContent="GAME OVER",b.announceWinner(o),"GAME OVER"):"SHIP SUNK"):"HIT"}const r=document.createElement("img");return document.getElementById(`${n[t]}${e}${o}`).appendChild(r),r.src="../img/close-box.png","MISS"},attackedSpaces:[],noShipsLeft:function(){return this.totalShips===this.sunkShips},totalShips:0,sunkShips:0}),i=t=>({length:t,hitsTaken:0,isSunk:function(){return this.hitsTaken>=this.length},hit:function(){this.hitsTaken++}}),l="abcdefghijklmnopqrstuvwxyz".split(""),a=()=>({takeTurn:function(t,e,n){return console.log(t),this.opponentBoard.receiveAttack(l.indexOf(t),e,n)},opponentBoard:null,playerBoard:null}),s=(t,e)=>{let n=function(){let n=[];for(let o=1;o<t+1;o++)for(let t=0;t<e;t++)n.push(l[t]+o);return n}();return{takeTurn:function(){const t=Math.floor(Math.random()*n.length),e=n[t].split("");n.splice(t,1);const o=e.slice(1).join(""),r=l.indexOf(e[0]),i=this.opponentBoard.receiveAttack(r,o,"A");return b.nextTurn(),i},opponentBoard:null,playerBoard:null,availibleTargets:n,placeOwnShips:function(t){console.log(t);let e=[],o=n,r=n;e.push(o),e.push(r),t.forEach((t=>{let n=!1;for(;!n;){const o=Math.floor(2*Math.random()),r=Math.floor(Math.random()*e[o].length);this.playerBoard.placeShip(i(t),e[o][r],o,"B")&&(n=!0),console.log(n)}}))}}};let c=1;const u=function(t,o,r){const l=document.createElement("div");l.setAttribute("class","board"),l.setAttribute("id","board");for(let a=o;a>0;a--){const o=document.createElement("div");o.setAttribute("id",`row${a}`),o.setAttribute("class","row"),o.textContent=`${a}`,l.appendChild(o);for(let o=0;o<r;o++){const r=document.createElement("div");r.setAttribute("id",`${n[o]+a+t}`),(a+o)%2==1?r.setAttribute("class","B"===t?"red":"dark"):r.setAttribute("class","light"),l.appendChild(r),r.onmouseover=()=>{!1===b.mainState&&"A"===t?r.style.cursor=c?"url(../img/vert.png)25 10,auto":"url(../img/hor.png)25 10,auto":r.style.cursor="auto"},r.addEventListener("contextmenu",(function(t){t.preventDefault(),c=(c+1)%2}),!1),r.onclick=()=>{let t=r.id.split("");const n=t.splice(-1).join(""),o=t.splice(1).join(""),l=t[0];if(!0===b.mainState){if(console.log(r.id),"B"===n){const t=b.playerA.takeTurn(l,o,n);console.log(`STATUS: ${t}`),t&&b.nextTurn()}}else"A"===n&&(b.playerA.playerBoard.placeShip(i(b.shipArr[b.playerA.playerBoard.totalShips]),l+o,c,"A"),b.playerA.playerBoard.totalShips>=b.shipArr.length&&(b.mainState=!0));e()}}}let a=n;return a.unshift(""),a.splice(r+1),a.forEach((t=>{const e=document.createElement("div");e.setAttribute("id",`col${t}`),e.setAttribute("class","col"),e.textContent=t,l.appendChild(e)})),a.shift(),l},d=document.getElementById("content"),p=document.createElement("div");p.setAttribute("id","announcer"),d.appendChild(p);const h=document.createElement("div");h.setAttribute("id","playerB");const m=document.createElement("div");m.setAttribute("id","playerA");const f=u("B",10,10),g=u("A",10,10);d.appendChild(m),d.appendChild(h),h.appendChild(g),m.appendChild(f);let b=((t,e,n,o)=>{const i=a(),l=t?s(e,n):a();i.playerBoard=r(e,n),l.playerBoard=r(e,n),i.opponentBoard=l.playerBoard,l.opponentBoard=i.playerBoard;l.placeOwnShips(o);let c=!0;return{playerA:i,playerB:l,mainState:false,announceWinner:function(t){console.log(false),"A"===t?console.log("Player B Wins"):console.log("Player A wins")},nextTurn:function(){this.gameOver||(console.log("next turn"),c=!c,!c&&t&&l.takeTurn())},gameOver:!1,shipArr:o}})(!0,10,10,[5,4,3,3,2]);e()})();